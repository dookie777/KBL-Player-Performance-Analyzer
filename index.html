<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basketball Stats Analyzer</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  body { background-color: #121212; color: #FFFFFF; font-family: Arial, sans-serif; margin: 0; padding: 0; overflow: hidden; }
  .container { display: flex; flex-direction: column; height: 100vh; max-width: 1200px; margin: auto; padding: 20px; box-sizing: border-box; }
  h2, .input-box, .checkbox-group, .footer { text-align: center; }
  h2 { color: #FFA500; }
  .input-box, .checkbox-group { padding: 10px 0; background-color: #1e1e1e; }
  .scroll-container { flex: 1; overflow-y: auto; margin: 10px 0; }
  table { width: 100%; border-collapse: collapse; }
  th, td { padding: 10px; text-align: center; border-bottom: 1px solid #333; }
  th { background-color: #282828; position: sticky; top: 0; }
  td { background-color: #181818; }
  .warning { color: #FF5555; }
  .valid { color: #55FF55; }
  .footer { padding: 10px 0; border-top: 1px solid #333; font-size: 0.8rem; color: #888; position: fixed; bottom: 0; left: 0; width: 100%; background-color: #000000; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 1000; }
  .footer img { width: 100px; height: auto; margin-bottom: 5px; }
</style>
</head>
<body>
<div class="container">
  <h2>Basketball Stats Analyzer</h2>

  <div class="input-box">
    <input type="text" id="playerSearch" placeholder="Search player..." />
    <button onclick="searchPlayer()">Search</button>
  </div>

  <div class="checkbox-group">
    <label><input type="checkbox" value="PTS_avg" checked> Points</label>
    <label><input type="checkbox" value="TRB_avg"> Rebounds</label>
    <label><input type="checkbox" value="AST_avg"> Assists</label>
    <label><input type="checkbox" value="STL_avg"> Steals</label>
    <label><input type="checkbox" value="BLK_avg"> Blocks</label>
    <button onclick="comparePlayers()">Compare</button>
  </div>

  <div class="scroll-container">
    <table id="statsTable">
      <thead>
        <tr>
          <th>Player</th><th>Team</th><th>G</th><th>PTS_avg</th><th>TRB_avg</th><th>AST_avg</th>
        </tr>
      </thead>
      <tbody id="tableBody"></tbody>
    </table>
  </div>

  <footer class="footer">
    <img src="https://github.com/dookie777/vibe-index/blob/main/Logo_white.png?raw=true" alt="The Eroom Sports Logo">
    <div>© 2025 The Eroom Sports. All rights reserved.</div>
  </footer>
</div>

<script>
const playersData = [];

async function loadPlayersData() {
  const response = await fetch('https://docs.google.com/spreadsheets/d/1ez03AkQt4A5HWmo3jRAV3DOyfKfCU4xiI7XCjLRjwnE/export?format=csv');
  const data = await response.text();
  const rows = data.split('\n').slice(1);

  rows.forEach(row => {
    const cols = row.split(',');
    if(cols.length > 29) {
      playersData.push({
        Season: cols[0], Team: cols[1], Player: cols[2], G: Number(cols[3]),
        m: Number(cols[4]), s: Number(cols[5]),
        PTS_avg: Number(cols[7]), TRB_avg: Number(cols[23]),
        AST_avg: Number(cols[25]), STL_avg: Number(cols[27]), BLK_avg: Number(cols[29])
      });
    }
  });

  populateTable();
}

function populateTable() {
  const tableBody = document.getElementById('tableBody');
  tableBody.innerHTML = '';
  playersData.forEach(player => {
    const status = player.G >= 20 ? '<span class="valid">✅</span>' : '<span class="warning">⚠️</span>';
    const row = `<tr>
      <td>${player.Player} ${status}</td><td>${player.Team}</td><td>${player.G}</td>
      <td>${player.PTS_avg.toFixed(2)}</td><td>${player.TRB_avg.toFixed(2)}</td>
      <td>${player.AST_avg.toFixed(2)}</td>
    </tr>`;
    tableBody.innerHTML += row;
  });
}

function searchPlayer() {
  const query = document.getElementById('playerSearch').value;
  const player = playersData.find(p => p.Player.toLowerCase().includes(query.toLowerCase()));

  if (player) {
    alert(`Player: ${player.Player}\nTeam: ${player.Team}\nGames: ${player.G}\nPoints Avg: ${player.PTS_avg}\nRebounds Avg: ${player.TRB_avg}\nAssists Avg: ${player.AST_avg}\nPlaytime: ${player.m}m ${player.s}s`);
  } else {
    alert('Player not found');
  }
}

function comparePlayers() {
  alert('Comparison feature coming soon!');
}

window.onload = loadPlayersData;
</script>
</body>
</html>
