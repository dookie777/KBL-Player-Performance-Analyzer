<!DOCTYPE html>
<html lang="en">
<head>
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <meta charset="UTF-8">
  <title>23-24 KBL Player Stats Analyzer</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@700&display=swap" rel="stylesheet">

  <style>
body { 
  background-color: #121212; 
  background-image: 
    linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px),
    linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px);
  background-size: 30px 30px;
  background-position: center;
  color: #FFF;
  font-family: Arial, sans-serif;
  margin: 0;
  padding: 0;
  overflow: hidden;
}
/* âœ… ì¢Œìš° ìŠ¤í¬ë¡¤ ì‹œ 1,2ì—´ ì œëª© ê³ ì • ì™„ë²½ ë³µêµ¬ */
#tab-all table {
  position: relative;
}

#tab-all th:nth-child(1),
#tab-all td:nth-child(1),
#tab-all th:nth-child(2),
#tab-all td:nth-child(2) {
  position: sticky;
  background-color: #282828 !important;
  z-index: 10;
}

#tab-all th:nth-child(1),
#tab-all td:nth-child(1) {
  left: 0;
  z-index: 11; /* ì´ë¦„ ì—´ì´ ìµœìš°ì„ ìœ¼ë¡œ ë³´ì´ê²Œ ì„¤ì • */
}

#tab-all th:nth-child(2),
#tab-all td:nth-child(2) {
  left: 150px;
  z-index: 10; /* íŒ€ ì—´ì´ ì´ë¦„ ì—´ ë‹¤ìŒìœ¼ë¡œ ë³´ì´ê²Œ ì„¤ì • */
}

/* ìŠ¤í¬ë¡¤ ì‹œ í—¤ë” ì—´ (ìƒë‹¨) ê³ ì • */
#tab-all thead th {
  position: sticky;
  top: 0;
  background-color: #282828 !important;
  z-index: 12; /* ì—´ ì œëª©ì´ ê°€ì¥ ìœ„ì— ì˜¤ë„ë¡ ì„¤ì • */
}

.container {
  max-width: 1200px;
  margin: auto;
  padding: 20px;
  box-sizing: border-box;
  height: 100vh;
  display: flex;
  flex-direction: column;
}

h2 {
  text-align: center;
  color: #FFA500;
}

.tabs {
  text-align: center;
  margin-bottom: 15px;
}

.tabs button {
  background: #282828;
  color: #FFF;
  padding: 10px 20px;
  border: none;
  cursor: pointer;
  margin: 0 5px;
  font-weight: bold;
  width: 160px;
}

.tabs button.active {
  background: #E0E0E0;
  color: #000;
}

.tab-content {
  display: none !important;
  flex-direction: column;
  flex: 1;
  overflow: hidden !important;
}

.tab-content.active {
  display: flex !important;
}

.input-box {
  display: flex;
  justify-content: center;
  align-items: center;
  flex-wrap: wrap;
  margin-bottom: 20px;
}

.input-box input[type="text"],
.input-box button {
  height: 42px !important; /* ì •í™•íˆ ë²„íŠ¼ ë†’ì´ì™€ ë™ì¼í•˜ê²Œ ê³ ì • */
  padding: 5px 15px;
  font-size: 0.9rem;
  border-radius: 5px;
  border: none;
  margin: 5px;
  box-sizing: border-box; /* paddingê³¼ borderê°€ heightì— í¬í•¨ë˜ë„ë¡ ì„¤ì • */
}


.input-box input[type="text"] {
  width: 250px;
  font-size: 1rem;
}

.input-box button {
  background-color: #88c2dd;
  color: #121212;
  cursor: pointer;
  font-weight: bold;
}

.input-box input[type="checkbox"] {
  margin: 0 5px;
}

.input-box label {
  color: #FFF;
  font-size: 0.9rem;
  cursor: pointer;
  user-select: none;
}

.scroll-container, .stats-container, .compare-result {
  flex: 1;
  overflow: auto;
}

.scroll-container::-webkit-scrollbar,
.stats-container::-webkit-scrollbar,
.compare-result::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}

.scroll-container::-webkit-scrollbar-track,
.stats-container::-webkit-scrollbar-track,
.compare-result::-webkit-scrollbar-track {
  background: #121212;
  border-radius: 5px;
}

.scroll-container::-webkit-scrollbar-thumb,
.stats-container::-webkit-scrollbar-thumb,
.compare-result::-webkit-scrollbar-thumb {
  background: #555;
  border-radius: 5px;
  border: 2px solid #121212;
}

.scroll-container::-webkit-scrollbar-thumb:hover,
.stats-container::-webkit-scrollbar-thumb:hover,
.compare-result::-webkit-scrollbar-thumb:hover {
  background: #FFA500;
}

table {
  border-collapse: collapse;
  white-space: nowrap;
  width: max-content;
}

th, td {
  padding: 8px;
  border-bottom: 1px solid #333;
  font-size: 0.85rem;
  text-align: center;
  background: #181818;
  font-weight: bold;
}

thead th {
  background: #282828;
  position: sticky;
  top: 0;
  cursor: pointer;
  z-index: 500;
}

#tab-all th:nth-child(1), #tab-all td:nth-child(1),
#tab-all th:nth-child(2), #tab-all td:nth-child(2) {
  position: sticky;
  background-color: #282828 !important;
  z-index: 400;
}

#tab-all th:nth-child(1), #tab-all td:nth-child(1) {
  left: 0;
}

#tab-all th:nth-child(2), #tab-all td:nth-child(2) {
  left: 150px;
}

.highlight { 
  color: #FFFF55 !important; 
  font-weight: bold; 
}

.player-name {
  font-size: 2rem;
  font-weight: bold;
  margin: 15px 0 5px;
  text-align: center;
}

.team-name {
  font-size: 1rem;
  text-align: center;
  margin-bottom: 15px;
}

.stats-container {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 15px;
  margin-top: 20px;
  padding-bottom: 60px;
}

.card {
  background-color: rgba(255,255,255,0.05);
  padding: 10px;
  border-radius: 10px;
  text-align: center;
  min-height: 350px;
}

.card.primary:nth-child(2) { min-height: 420px; }
.card.primary h3 { color: #FFA500; }
.card.secondary h3 { color: #88c2dd; }

.card h3 {
  margin: 0 0 8px;
  font-size: 1.1rem;
}

.card table {
  width: 100%;
}

.card th, .card td {
  padding: 8px 5px;
  border-bottom: 1px solid rgba(255,255,255,0.2);
}

.card.team-stats {
  min-height: 380px !important;
}

.card.team-stats h3 {
  color: #88c2dd !important;
}

#tab-compare .compare-result table {
  table-layout: auto !important;
  transform: none !important;
}

#tab-compare .compare-result th,
#tab-compare .compare-result td {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding: 10px 15px !important;
  font-size: 0.85rem !important;
}

#tab-compare .compare-result thead th {
  position: sticky;
  top: 0;
  background-color: #282828 !important;
  z-index: 10;
}

.highlight-first {
  background-color: rgba(255,140,0,0.95) !important;
  color: #FFF !important;
}

.highlight-second {
  background-color: rgba(70,150,200,0.95) !important;
  color: #FFF !important;
}

.highlight-third {
  background-color: rgba(160,160,160,0.95) !important;
  color: #FFF !important;
}

.footer {
  text-align: center;
  padding: 10px;
  font-size: 0.8rem;
  color: #888;
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  background-color: #000;
  pointer-events: none;
}
/* âœ… 1í˜ì´ì§€ í—¤ë” ì™„ë²½ ê³ ì • (ê¸´ê¸‰ í•´ê²° ì¬ì ìš©) */
#tab-all th:nth-child(1),
#tab-all th:nth-child(2) {
  position: sticky;
  top: 0 !important;
  background-color: #282828 !important;
  z-index: 500 !important;
}

#tab-all td:nth-child(1),
#tab-all td:nth-child(2) {
  position: sticky;
  left: 0;
  background-color: #282828 !important;
  z-index: 400 !important;
}

#tab-all th:nth-child(2),
#tab-all td:nth-child(2) {
  left: 150px;
}

/* âœ… ì„ ìˆ˜ ê°œì¸ ê²€ìƒ‰ í˜ì´ì§€ ê°„ê²© ì¶•ì†Œ (ì¤‘ìš” ìˆ˜ì •) */
#tab-player .input-box {
  margin-bottom: 10px !important; /* ê¸°ì¡´ 20px â†’ ì ˆë°˜ìœ¼ë¡œ ìˆ˜ì • */
}

#tab-player .player-name {
  margin: 8px 0 3px 0 !important; /* ê¸°ì¡´ 15px, 5px â†’ ì ˆë°˜ìœ¼ë¡œ ìˆ˜ì • */
}

#tab-player .team-name {
  margin-bottom: 8px !important; /* ê¸°ì¡´ 15px â†’ ì ˆë°˜ìœ¼ë¡œ ìˆ˜ì • */
}

#tab-player .stats-container {
  margin-top: 10px !important; /* ê¸°ì¡´ 20px â†’ ì ˆë°˜ìœ¼ë¡œ ìˆ˜ì • */
}

/* âœ… ì„ ìˆ˜ ë¹„êµ í˜ì´ì§€ ì…ë ¥ì°½ í¬ê¸° ë° ì˜ì—­ ìµœì í™” (ì¤‘ìš” ìˆ˜ì •) */
#tab-compare .input-box input[type="text"] {
  width: 150px !important; /* ê¸°ì¡´ 200px â†’ 2/3 í¬ê¸° */
}

#tab-compare .input-box {
  justify-content: space-between; /* ë„“ì€ ì˜ì—­ í™œìš© */
  max-width: 900px;
  margin: 0 auto 10px auto !important;
  padding: 0;
}

/* ì…ë ¥ì°½ê³¼ ë²„íŠ¼ ì •ë ¬ ìµœì í™” */
#tab-compare .input-box button {
  flex-grow: 1;
  max-width: 100px;
  margin: 5px;
}

/* ì²´í¬ë°•ìŠ¤ ë° ë¼ë²¨ ìš°ì¸¡ ì •ë ¬ */
#tab-compare .input-box input[type="checkbox"],
#tab-compare .input-box label {
  flex-grow: 1;
  text-align: right;
  margin: 0 5px;
}

#tab-compare .compare-result {
  max-width: 900px !important;
  width: 100% !important;
  margin: 0 auto;
  padding: 10px !important;
  overflow: auto !important;
  height: calc(100vh - 270px) !important; /* ğŸ‘ˆ ì—¬ìœ  ê³µê°„ í™•ë³´ */
  box-sizing: border-box !important;
  position: relative;
  background-color: #121212 !important;
  padding-bottom: 60px !important; /* ğŸ‘ˆ í‘¸í„° ì¶©ëŒ ë°©ì§€ */
}

/* í…Œì´ë¸” ë„ˆë¹„ ì •í™•íˆ ì¡°ì • */
#tab-compare .compare-result table {
  width: 100% !important;
  min-width: 100% !important;
  table-layout: fixed !important; /* ê· ì¼í•˜ê²Œ ë„ˆë¹„ ì ìš© */
}
/* ìŠ¤í¬ë¡¤ ì‹œ ë°ì´í„°ê°€ í—¤ë” ë’¤ë¡œ ë³´ì´ëŠ” í˜„ìƒ ìˆ˜ì • */
#tab-compare .compare-result th {
  background-color: #282828 !important;
  position: sticky !important;
  top: 0 !important;
  z-index: 1000 !important;
}

/* ì œëª© í—¤ë” ë°°ê²½ìœ¼ë¡œ ë°ì´í„°ê°€ ë³´ì´ì§€ ì•Šê²Œ ì„¤ì • */
#tab-compare .compare-result {
  position: relative;
  background-color: #121212 !important;
}

/* ì°¨ì´ ì—´ ê²°ê³¼ê°’ í°íŠ¸ ì‘ê²Œ ì¡°ì • */
#tab-compare .compare-result td.diff-cell span {
  font-size: 0.9rem !important; /* í°íŠ¸ í¬ê¸° 1.2remìœ¼ë¡œ ì§€ì • */
}
#tab-compare .compare-result td {
  position: relative !important;
  z-index: 1 !important;
}
    
/* ë¹¨ê°„ ì •ì‚¼ê°í˜• ì•„ì´ì½˜ ì¶”ê°€ ìŠ¤íƒ€ì¼ */
.diff-positive::before {
  content: "â–²";
  color: red;
  margin-right: 4px;
  font-size: 0.8rem;
}
/* ìŒìˆ˜(-)ê°’: íŒŒë€ ì—­ì‚¼ê°í˜• ì•„ì´ì½˜ ì¶”ê°€ */
.diff-negative::before {
  content: "â–¼";
  color: skyblue;
  margin-right: 5px;
  font-size: 0.8rem;
}

.category-checkboxes {
  display: grid;
  grid-template-columns: repeat(6, 1fr); /* ìƒë‹¨ 6ê°œ í•­ëª©ì„ ê· ë“±í•˜ê²Œ ë‚˜ëˆ„ê¸° ìœ„í•´ 6ì¹¸ ì„¤ì • */
  gap: 10px 20px; /* ì„¸ë¡œ 10px, ê°€ë¡œ 20px ê°„ê²© */
  max-width: 900px;
  margin: 10px auto;
  justify-content: center;
  align-items: center;
}

.category-checkboxes label {
  white-space: nowrap;
  display: flex;
  align-items: center;
  justify-content: center;
}

.category-checkboxes input[type="checkbox"] {
  margin-right: 5px;
}

/* ìƒë‹¨ 6ê°œ í•­ëª© ì •í™•íˆ ê· ë“± ë°°ì¹˜ (í•œ í–‰ì— í•˜ë‚˜ì”© ì •í™•íˆ ë“¤ì–´ê°€ë„ë¡ ì„¤ì •) */
.category-checkboxes label:nth-child(-n+6) {
  grid-column: span 1; /* 6ê°œ í•­ëª© ì •í™•íˆ í•œ ì¹¸ì”© ë‚˜ëˆ” */
}

/* í•˜ë‹¨ 4ê°œ í•­ëª©ì€ ë” ë„“ê²Œ, ì •í™•íˆ ì¤‘ì•™ ì •ë ¬ */
.category-checkboxes label:nth-child(n+7) {
  grid-column: span 1; /* ë„“ê²Œ 2ì¹¸ì”© ì‚¬ìš©í•˜ì—¬ ì—¬ìœ ë¥¼ ë‘  */
}

/* í•˜ë‹¨ 4ê°œ í•­ëª©ì´ ì •í™•íˆ ì¤‘ì•™ ì •ë ¬ë˜ë„ë¡ ì‹œì‘ ìœ„ì¹˜ ì§€ì • */
.category-checkboxes label:nth-child(7) {
  grid-column-start: 2; /* ì •í™•íˆ ì¤‘ì•™ ì‹œì‘ì  ì§€ì • */
}

.category-checkboxes label:nth-child(2) {
  margin-left: -40px; /* ìŠˆíŒ… ì§€í‘œë¥¼ WinShare ì§€í‘œì— ë§ì¶¤ */
}

.category-checkboxes label:nth-child(10) {
  margin-left: -38px; /* Teamë‚´ ë¹„ì¤‘ ì§€í‘œë¥¼ ì–´ì‹œìŠ¤íŠ¸ì— ë§ì¶¤ */
}
.side-logo {
  position: fixed;
  top: 65%; /* í™”ë©´ ì¤‘ì•™ë³´ë‹¤ ì¡°ê¸ˆ ì•„ë˜ (ì œì‹œí•˜ì‹  í°ìƒ‰ ì„  ë†’ì´) */
  transform: translateY(-50%);
  width: 160px; 
  height: 160px;
  background: transparent;
  z-index: 1000;
}

.side-logo.left {
  left: 120px; 
}

.side-logo.right {
  position: fixed;
  top: calc(50% + 170px); /* ì¤‘ì•™ì—ì„œ ì•„ë˜ë¡œ 80px ë‚´ë ¤ê° (ë‚˜ì´ì¸  ë¡œê³  ì¤‘ì‹¬ì  ë§ì¶”ê¸°) */
  right: 120px;
  width: 160px;
  height: 150px;
  background: transparent;
  z-index: 1000;
}

.side-logo img {
  width: 90%;
  height: auto;
  display: block;
  margin: auto;
}
/* âœ… ì œëª© íŠ¸ë Œë”” ìŠ¤íƒ€ì¼ë§ ì¶”ê°€ */
h2 {
  font-family: 'Poppins', sans-serif;
  font-size: 2rem;
  color: #fff;
  text-shadow: 
    0 0 3px #ff8c00, 
    0 0 6px #ff8c00, 
    0 0 12px #ff4500; 
  letter-spacing: 1px;
  animation: glow 2s infinite alternate;
}

@keyframes glow {
  from { 
    text-shadow: 0 0 3px #ff8c00, 0 0 6px #ff4500; 
  }
  to { 
    text-shadow: 0 0 6px #ff8c00, 0 0 12px #ff4500; 
  }
}
#tab-compare .compare-result::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 42px;
  background-color: #121212;
  z-index: 5;
  pointer-events: none;
}

    
  </style>
</head>
<body>
  <div class="side-logo left">
  <img src="Seoul_SK_Knights_logo.svg.png" alt="Seoul SK Knights Logo">
</div>

<div class="side-logo right">
  <img src="SKí…”ë ˆì½¤_ë¡œê³ .svg.png" alt="SK Telecom Logo">
</div>
<div class="container">
  <h2>23-24 KBL Player Stats Analyzer</h2>
  <div class="tabs">
    <button class="tab-button active" data-tab="tab-all">ì„ ìˆ˜ ì „ì²´ ê²€ìƒ‰</button>
    <button class="tab-button" data-tab="tab-player">ì„ ìˆ˜ ê°œì¸ ê²€ìƒ‰</button>
    <button class="tab-button" data-tab="tab-compare">ì„ ìˆ˜ ë¹„êµ ê²€ìƒ‰</button>
  </div>

<div id="tab-all" class="tab-content active">
  <div class="input-box">
    <input type="text" id="searchPlayerAll" placeholder="Search player...">
    <button onclick="searchPlayer()">Search</button>
    <input type="checkbox" id="minGamesCheckbox">
    <label for="minGamesCheckbox">ê·œì • ê²½ê¸° ì´ìƒ(14G)</label>
  </div>

<div style="position:fixed; top:10px; right:10px; display:flex; align-items:center; gap:5px;">
  <input type="file" id="fileUploader" accept=".xlsx, .xls" style="font-size:0.75rem; color:#FFF;">
  <button onclick="loadLocalFile()" style="background:#555; color:#FFF; padding:4px 8px; border-radius:4px; font-size:0.75rem; cursor:pointer; border:none;">ì—…ë¡œë“œ</button>
</div>


  
  <div class="scroll-container" style="overflow:auto; flex:1;">
    <table id="statsTable" style="width:max-content; min-width:100%;">
     <thead>
  <tr>
    <th>Player</th>
    <th>Team</th>
    <th>ì¶œì „ ê²½ê¸° ìˆ˜</th>
    <th>ì¶œì „ ì‹œê°„(ì´ˆ)</th>
    <th>ë“ì </th>
    <th>í‰ê·  ë“ì </th>
    <th>FGA</th>
    <th>FG</th>
    <th>í‰ê·  FG ì‹œë„</th>
    <th>í‰ê·  FG ì„±ê³µ</th>
    <th>FG%</th>
    <th>2PA</th>
    <th>2P</th>
    <th>í‰ê·  2p ì‹œë„</th>
    <th>í‰ê·  2p ì„±ê³µ</th>
    <th>2P%</th>
    <th>3PA</th>
    <th>3P</th>
    <th>í‰ê·  3p ì‹œë„</th>
    <th>í‰ê·  3p ì„±ê³µ</th>
    <th>3P%</th>
    <th>FTA</th>
    <th>FT</th>
    <th>í‰ê·  FT ì‹œë„</th>
    <th>í‰ê·  FT ì„±ê³µ</th>
    <th>FT%</th>
    <th>ë¦¬ë°”ìš´ë“œ</th>
    <th>í‰ê·  ë¦¬ë°”ìš´ë“œ</th>
    <th>ê³µê²© ë¦¬ë°”ìš´ë“œ</th>
    <th>í‰ê·  ê³µê²© ë¦¬ë°”ìš´ë“œ</th>
    <th>ìˆ˜ë¹„ ë¦¬ë°”ìš´ë“œ</th>
    <th>í‰ê·  ìˆ˜ë¹„ ë¦¬ë°”ìš´ë“œ</th>
    <th>ì–´ì‹œìŠ¤íŠ¸</th>
    <th>í‰ê·  ì–´ì‹œìŠ¤íŠ¸</th>
    <th>ìŠ¤í‹¸</th>
    <th>í‰ê·  ìŠ¤í‹¸</th>
    <th>ë¸”ë¡</th>
    <th>í‰ê·  ë¸”ë¡</th>
    <th>í„´ì˜¤ë²„</th>
    <th>í‰ê·  í„´ì˜¤ë²„</th>
    <th>íŒŒìš¸</th>
    <th>í‰ê·  íŒŒìš¸</th>
    <th>WS</th>
    <th>WS/40</th>
    <th>Offensive_WS</th>
    <th>Defensive_WS</th>
    <th>PER</th>
    <th>EFF</th>
    <th>EFF/40</th>
    <th>Offensive_rating</th>
    <th>Defensive_rating</th>
    <th>USG%</th>
    <th>TS%</th>
    <th>eFG%</th>
    <th>3PAr</th>
    <th>FTr</th>
    <th>ORB%</th>
    <th>DRB%</th>
    <th>TRB%</th>
    <th>AST%</th>
    <th>STL%</th>
    <th>BS%</th>
    <th>TOV%</th>
  </tr>
</thead>

      <tbody id="tableBody"></tbody>
    </table>
  </div>
</div>


  <div id="tab-player" class="tab-content">
    <div class="input-box">
      <input type="text" id="searchPlayer" placeholder="Search player...">
      <button onclick="showPlayerStats()">Search</button>
      <input type="checkbox" id="minGames">
      <label for="minGames">ê·œì • ê²½ê¸° ì´ìƒ(14G)</label>
    </div>
    <div class="player-name" id="playerName"></div>
    <div class="team-name" id="teamName"></div>
    <div class="stats-container" id="statsContainer"></div>
  </div>
<div id="tab-compare" class="tab-content">
<div class="input-box">
  <input type="text" id="comparePlayer1" placeholder="ì„ ìˆ˜ 1 ì´ë¦„ ì…ë ¥">
  <input type="text" id="comparePlayer2" placeholder="ì„ ìˆ˜ 2 ì´ë¦„ ì…ë ¥">
  <input type="text" id="comparePlayer3" placeholder="ì„ ìˆ˜ 3 ì´ë¦„ ì…ë ¥ (ì„ íƒ)">
<button onclick="comparePlayers()">Compare</button>
  <input type="checkbox" id="compareMinGames">
  <label for="compareMinGames">ê·œì • ê²½ê¸° ì´ìƒ(14G)</label>
</div>
  <div id="categoryCheckboxes" class="category-checkboxes">
    <label><input type="checkbox" value="ê¸°ë³¸ ì •ë³´" checked> ê¸°ë³¸ ì •ë³´</label>
    <label><input type="checkbox" value="ìŠˆíŒ… ì§€í‘œ" checked> ìŠˆíŒ… ì§€í‘œ</label>
    <label><input type="checkbox" value="ìŠˆíŒ… ì„±ê³µë¥ " checked> ìŠˆíŒ… ì„±ê³µë¥ </label>
    <label><input type="checkbox" value="ë¦¬ë°”ìš´ë“œ ì§€í‘œ" checked> ë¦¬ë°”ìš´ë“œ ì§€í‘œ</label>
    <label><input type="checkbox" value="ì–´ì‹œìŠ¤íŠ¸/ìŠ¤í‹¸/ë¸”ë¡ ì§€í‘œ" checked> ì–´ì‹œìŠ¤íŠ¸/ìŠ¤í‹¸/ë¸”ë¡ ì§€í‘œ</label>
    <label><input type="checkbox" value="ê¸°íƒ€ ì§€í‘œ" checked> ê¸°íƒ€ ì§€í‘œ</label>
    <label><input type="checkbox" value="WinShare ì§€í‘œ" checked> WinShare ì§€í‘œ</label>
    <label><input type="checkbox" value="íš¨ìœ¨ì„± ì§€í‘œ" checked> íš¨ìœ¨ì„± ì§€í‘œ</label>
    <label><input type="checkbox" value="2ì°¨ ìŠˆíŒ… ì§€í‘œ" checked> 2ì°¨ ìŠˆíŒ… ì§€í‘œ</label>
    <label><input type="checkbox" value="Teamë‚´ ë¹„ì¤‘ ì§€í‘œ" checked> Teamë‚´ ë¹„ì¤‘ ì§€í‘œ</label>
  </div>
  <div class="compare-result" id="compareResult">
  </div>
</div>
  <footer class="footer">
    Â© 2025 The Eroom Sports. All rights reserved.
  </footer>
</div>

<script>
const statsFormats = {
  "ì¶œì „ ê²½ê¸° ìˆ˜": {unit: 'ê²½ê¸°', decimals: 0},
  "ì´ ì¶œì „ ì‹œê°„(ì´ˆ)": {unit: 'ë¶„ ì´ˆ', decimals: 0, convert: true},
  "ë“ì ": {unit: 'ì ', decimals: 0},
  "í‰ê·  ë“ì ": {unit: 'ì ', decimals: 2},
  "FGA": {unit: 'ê°œ', decimals: 0},
  "FG": {unit: 'ê°œ', decimals: 0},
  "í‰ê·  FG ì‹œë„": {unit: 'ê°œ', decimals: 2},
  "í‰ê·  FG ì„±ê³µ": {unit: 'ê°œ', decimals: 2},
  "FG%": {unit: '%', decimals: 2},
  "2PA": {unit: 'ê°œ', decimals: 0},
  "2P": {unit: 'ê°œ', decimals: 0},
  "í‰ê·  2p ì‹œë„": {unit: 'ê°œ', decimals: 2},
  "í‰ê·  2p ì„±ê³µ": {unit: 'ê°œ', decimals: 2},
  "2P%": {unit: '%', decimals: 2},
  "3PA": {unit: 'ê°œ', decimals: 0},
  "3P": {unit: 'ê°œ', decimals: 0},
  "í‰ê·  3p ì‹œë„": {unit: 'ê°œ', decimals: 2},
  "í‰ê·  3p ì„±ê³µ": {unit: 'ê°œ', decimals: 2},
  "3P%": {unit: '%', decimals: 2},
  "FTA": {unit: 'ê°œ', decimals: 0},
  "FT": {unit: 'ê°œ', decimals: 0},
  "í‰ê·  FT ì‹œë„": {unit: 'ê°œ', decimals: 2},
  "í‰ê·  FT ì„±ê³µ": {unit: 'ê°œ', decimals: 2},
  "FT%": {unit: '%', decimals: 2},
  "ë¦¬ë°”ìš´ë“œ": {unit: 'ê°œ', decimals: 0},
  "í‰ê·  ë¦¬ë°”ìš´ë“œ": {unit: 'ê°œ', decimals: 2},
  "ê³µê²© ë¦¬ë°”ìš´ë“œ": {unit: 'ê°œ', decimals: 0},
  "í‰ê·  ê³µê²© ë¦¬ë°”ìš´ë“œ": {unit: 'ê°œ', decimals: 2},
  "ìˆ˜ë¹„ ë¦¬ë°”ìš´ë“œ": {unit: 'ê°œ', decimals: 0},
  "í‰ê·  ìˆ˜ë¹„ ë¦¬ë°”ìš´ë“œ": {unit: 'ê°œ', decimals: 2},
  "ì–´ì‹œìŠ¤íŠ¸": {unit: 'ê°œ', decimals: 0},
  "í‰ê·  ì–´ì‹œìŠ¤íŠ¸": {unit: 'ê°œ', decimals: 2},
  "ìŠ¤í‹¸": {unit: 'ê°œ', decimals: 0},
  "í‰ê·  ìŠ¤í‹¸": {unit: 'ê°œ', decimals: 2},
  "ë¸”ë¡": {unit: 'ê°œ', decimals: 0},
  "í‰ê·  ë¸”ë¡": {unit: 'ê°œ', decimals: 2},
  "í„´ì˜¤ë²„": {unit: 'ê°œ', decimals: 0},
  "í‰ê·  í„´ì˜¤ë²„": {unit: 'ê°œ', decimals: 2},
  "íŒŒìš¸": {unit: 'ê°œ', decimals: 0},
  "í‰ê·  íŒŒìš¸": {unit: 'ê°œ', decimals: 2},
  "WS": {unit: '', decimals: 3},
  "WS/40": {unit: '', decimals: 3},
  "Offensive_WS": {unit: '', decimals: 3},
  "Defensive_WS": {unit: '', decimals: 3},
  "PER": {unit: '', decimals: 3},
  "EFF": {unit: '', decimals: 3},
  "EFF/40": {unit: '', decimals: 3},
  "Offensive_rating": {unit: '', decimals: 3},
  "Defensive_rating": {unit: '', decimals: 3},
  "TS%": {unit: '%', decimals: 3},
  "eFG%": {unit: '%', decimals: 3},
  "USG%": {unit: '%', decimals: 3},
  "3PAr": {unit: '', decimals: 3},
  "FTr": {unit: '', decimals: 3},
  "ORB%": {unit: '%', decimals: 3},
  "DRB%": {unit: '%', decimals: 3},
  "TRB%": {unit: '%', decimals: 3},
  "AST%": {unit: '%', decimals: 3},
  "STL%": {unit: '%', decimals: 3},
  "BS%": {unit: '%', decimals: 3},
  "TOV%": {unit: '%', decimals: 3}
};

  
 const tabs = document.querySelectorAll('.tab-button');
 const contents = document.querySelectorAll('.tab-content');
 
 tabs.forEach(tab => {
   tab.onclick = () => {
     tabs.forEach(t => t.classList.remove('active'));
     contents.forEach(c => c.classList.remove('active'));
     document.getElementById(tab.dataset.tab).classList.add('active');
     tab.classList.add('active');
   };
 });
 
 let originalData = [], highlightedPlayer = '', fixedRow = null;
 
async function loadPlayersData() {
  if (originalData.length === 0) {
    try {
      const url = 'https://raw.githubusercontent.com/dookie777/KBL-Player-Performance-Analyzer/main/23-24_KBL_stats.xlsx';
      const response = await fetch(url);
      const data = await response.arrayBuffer();

      const workbook = XLSX.read(data, { type: "array" });

      const firstSheet = workbook.SheetNames[0];
      originalData = XLSX.utils.sheet_to_json(workbook.Sheets[firstSheet]);

      originalData.forEach(cols => {
        let minutes = parseInt(cols["m"]) || 0;
        let seconds = parseInt(cols["s"]) || 0;
        cols["ì´ ì¶œì „ ì‹œê°„(ì´ˆ)"] = minutes * 60 + seconds;
      });

      console.log("ì›¹ ë°ì´í„° ë¡œë”© ì„±ê³µ!", originalData); // âœ… í™•ì¸ìš© ë¡œê·¸
      renderTable(originalData);

    } catch (error) {
      console.error("ì—‘ì…€ ë°ì´í„° ë¡œë”© ì˜¤ë¥˜:", error);
      alert("ì—‘ì…€ ë°ì´í„° ë¡œë”© ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
    }
  }
}




function renderTable(data) {
  const tableBody = document.getElementById('tableBody');
  tableBody.innerHTML = '';

  const minGamesOnly = document.getElementById('minGamesCheckbox').checked;
  const filteredData = minGamesOnly ? data.filter(cols => parseInt(cols["ì¶œì „ ê²½ê¸° ìˆ˜"]) >= 14) : data;

  filteredData.forEach(cols => {
    const playerName = cols["Player"];
    const status = parseInt(cols["ì¶œì „ ê²½ê¸° ìˆ˜"]) >= 14 ? 'âœ…' : 'âš ï¸';
    const totalSeconds = cols["ì´ ì¶œì „ ì‹œê°„(ì´ˆ)"]; // ì´ë¯¸ ê³„ì‚°ëœ ê°’ ì •í™•íˆ ì‚¬ìš©

    const minutes = Math.floor(totalSeconds / 60);
    const seconds = totalSeconds % 60;

const row = document.createElement('tr');
row.innerHTML = 
  <td>${playerName} <span class="${cols["ì¶œì „ ê²½ê¸° ìˆ˜"] >= 20 ? 'valid' : 'warning'}">${status}</span></td>
  <td>${cols["Team"]}</td>
  <td>${formatStatValue("ì¶œì „ ê²½ê¸° ìˆ˜", cols["ì¶œì „ ê²½ê¸° ìˆ˜"])}</td>
  <td data-time="${totalSeconds}">${formatStatValue("ì´ ì¶œì „ ì‹œê°„(ì´ˆ)", totalSeconds)}</td>
  <td>${formatStatValue("ë“ì ", cols["ë“ì "])}</td>
  <td>${formatStatValue("í‰ê·  ë“ì ", cols["í‰ê·  ë“ì "])}</td>
  <td>${formatStatValue("FGA", cols["FGA"])}</td>
  <td>${formatStatValue("FG", cols["FG"])}</td>
  <td>${formatStatValue("í‰ê·  FG ì‹œë„", cols["í‰ê·  FG ì‹œë„"])}</td>
  <td>${formatStatValue("í‰ê·  FG ì„±ê³µ", cols["í‰ê·  FG ì„±ê³µ"])}</td>
  <td>${formatStatValue("FG%", cols["FG%"])}</td>
  <td>${formatStatValue("2PA", cols["2PA"])}</td>
  <td>${formatStatValue("2P", cols["2P"])}</td>
  <td>${formatStatValue("í‰ê·  2p ì‹œë„", cols["í‰ê·  2p ì‹œë„"])}</td>
  <td>${formatStatValue("í‰ê·  2p ì„±ê³µ", cols["í‰ê·  2p ì„±ê³µ"])}</td>
  <td>${formatStatValue("2P%", cols["2P%"])}</td>
  <td>${formatStatValue("3PA", cols["3PA"])}</td>
  <td>${formatStatValue("3P", cols["3P"])}</td>
  <td>${formatStatValue("í‰ê·  3p ì‹œë„", cols["í‰ê·  3p ì‹œë„"])}</td>
  <td>${formatStatValue("í‰ê·  3p ì„±ê³µ", cols["í‰ê·  3p ì„±ê³µ"])}</td>
  <td>${formatStatValue("3P%", cols["3P%"])}</td>
  <td>${formatStatValue("FTA", cols["FTA"])}</td>
  <td>${formatStatValue("FT", cols["FT"])}</td>
  <td>${formatStatValue("í‰ê·  FT ì‹œë„", cols["í‰ê·  FT ì‹œë„"])}</td>
  <td>${formatStatValue("í‰ê·  FT ì„±ê³µ", cols["í‰ê·  FT ì„±ê³µ"])}</td>
  <td>${formatStatValue("FT%", cols["FT%"])}</td>
  <td>${formatStatValue("ë¦¬ë°”ìš´ë“œ", cols["ë¦¬ë°”ìš´ë“œ"])}</td>
  <td>${formatStatValue("í‰ê·  ë¦¬ë°”ìš´ë“œ", cols["í‰ê·  ë¦¬ë°”ìš´ë“œ"])}</td>
  <td>${formatStatValue("ê³µê²© ë¦¬ë°”ìš´ë“œ", cols["ê³µê²© ë¦¬ë°”ìš´ë“œ"])}</td>
  <td>${formatStatValue("í‰ê·  ê³µê²© ë¦¬ë°”ìš´ë“œ", cols["í‰ê·  ê³µê²© ë¦¬ë°”ìš´ë“œ"])}</td>
  <td>${formatStatValue("ìˆ˜ë¹„ ë¦¬ë°”ìš´ë“œ", cols["ìˆ˜ë¹„ ë¦¬ë°”ìš´ë“œ"])}</td>
  <td>${formatStatValue("í‰ê·  ìˆ˜ë¹„ ë¦¬ë°”ìš´ë“œ", cols["í‰ê·  ìˆ˜ë¹„ ë¦¬ë°”ìš´ë“œ"])}</td>
  <td>${formatStatValue("ì–´ì‹œìŠ¤íŠ¸", cols["ì–´ì‹œìŠ¤íŠ¸"])}</td>
  <td>${formatStatValue("í‰ê·  ì–´ì‹œìŠ¤íŠ¸", cols["í‰ê·  ì–´ì‹œìŠ¤íŠ¸"])}</td>
  <td>${formatStatValue("ìŠ¤í‹¸", cols["ìŠ¤í‹¸"])}</td>
  <td>${formatStatValue("í‰ê·  ìŠ¤í‹¸", cols["í‰ê·  ìŠ¤í‹¸"])}</td>
  <td>${formatStatValue("ë¸”ë¡", cols["ë¸”ë¡"])}</td>
  <td>${formatStatValue("í‰ê·  ë¸”ë¡", cols["í‰ê·  ë¸”ë¡"])}</td>
  <td>${formatStatValue("í„´ì˜¤ë²„", cols["í„´ì˜¤ë²„"])}</td>
  <td>${formatStatValue("í‰ê·  í„´ì˜¤ë²„", cols["í‰ê·  í„´ì˜¤ë²„"])}</td>
  <td>${formatStatValue("íŒŒìš¸", cols["íŒŒìš¸"])}</td>
  <td>${formatStatValue("í‰ê·  íŒŒìš¸", cols["í‰ê·  íŒŒìš¸"])}</td>
  <td>${formatStatValue("WS", cols["WS"])}</td>
  <td>${formatStatValue("WS/40", cols["WS/40"])}</td>
  <td>${formatStatValue("Offensive_WS", cols["Offensive_WS"])}</td>
  <td>${formatStatValue("Defensive_WS", cols["Defensive_WS"])}</td>
  <td>${formatStatValue("PER", cols["PER"])}</td>
  <td>${formatStatValue("EFF", cols["EFF"])}</td>
  <td>${formatStatValue("EFF/40", cols["EFF/40"])}</td>
  <td>${formatStatValue("Offensive_rating", cols["Offensive_rating"])}</td>
  <td>${formatStatValue("Defensive_rating", cols["Defensive_rating"])}</td>
  <td>${formatStatValue("USG%", cols["USG%"])}</td>
  <td>${formatStatValue("TS%", cols["TS%"])}</td>
  <td>${formatStatValue("eFG%", cols["eFG%"])}</td>
  <td>${formatStatValue("3PAr", cols["3PAr"])}</td>
  <td>${formatStatValue("FTr", cols["FTr"])}</td>
  <td>${formatStatValue("ORB%", cols["ORB%"])}</td>
  <td>${formatStatValue("DRB%", cols["DRB%"])}</td>
  <td>${formatStatValue("TRB%", cols["TRB%"])}</td>
  <td>${formatStatValue("AST%", cols["AST%"])}</td>
  <td>${formatStatValue("STL%", cols["STL%"])}</td>
  <td>${formatStatValue("BS%", cols["BS%"])}</td>
  <td>${formatStatValue("TOV%", cols["TOV%"])}</td>
;
tableBody.appendChild(row);

  });
}


 
function searchPlayer(){
  const query = document.getElementById('searchPlayerAll').value.toLowerCase().trim();
  clearFixedRow();
  const rows = document.querySelectorAll('#tableBody tr');
  let found = false;
  rows.forEach(row => {
    const name = row.cells[0].textContent.toLowerCase();
    row.classList.remove('highlight');
    if (name.includes(query)){
      found = true;
      row.classList.add('highlight');
      fixRow(row);
    }
  });
  if (!found) alert("Player not found!");
}
 
 function fixRow(row) {
  clearFixedRow();
  fixedRow = row.cloneNode(true);
  fixedRow.classList.add('fixed-row', 'highlight');
  fixedRow.style.position = 'sticky';
  fixedRow.style.top = '34px';
  fixedRow.style.backgroundColor = '#000';
  fixedRow.style.zIndex = '500';

  const releaseBtn = document.createElement('button');
  releaseBtn.textContent = 'í•´ì œ';
  releaseBtn.style.marginLeft = '10px';
  releaseBtn.onclick = () => {
    clearFixedRow();
    document.getElementById('searchPlayerAll').value = "";
  };

  fixedRow.cells[0].appendChild(releaseBtn);
  document.querySelector('#statsTable thead').after(fixedRow);
}

function clearFixedRow() {
  if (fixedRow) {
    const originalRows = document.querySelectorAll('#tableBody tr');
    originalRows.forEach(row => row.classList.remove('highlight'));
    fixedRow.remove();
  }
  fixedRow = null;
}
 
 const sortDirections = {};
 document.querySelectorAll('#statsTable th').forEach((header, index) => {
   sortDirections[index] = 'asc';
   header.onclick = () => sortTable(index);
 });
 
 function sortTable(i) {
   const tableBody = document.getElementById('tableBody');
   const rows = [...tableBody.rows];
   const direction = sortDirections[i] === 'asc' ? 'desc' : 'asc';
   sortDirections[i] = direction;
 
   rows.sort((a, b) => {
     let x, y;
     if (i === 3) {
       x = parseInt(a.cells[i].getAttribute('data-time'), 10);
       y = parseInt(b.cells[i].getAttribute('data-time'), 10);
     } else {
       x = parseFloat(a.cells[i].innerText) || 0;
       y = parseFloat(b.cells[i].innerText) || 0;
     }
     return direction === 'asc' ? x - y : y - x;
   }).forEach(row => tableBody.appendChild(row));
 
const currentSearch = document.getElementById('searchPlayerAll').value.trim();
   if (currentSearch !== "") searchPlayer(); 
   else clearFixedRow(); 
 }
 
 window.onload = loadPlayersData;
 
 document.getElementById('minGamesCheckbox').addEventListener('change', function() {
   renderTable(originalData);
 });

function calculateRank(filteredData, statKey, playerValue, isHigherBetter = true) {
  const sorted = filteredData
    .map(cols => parseFloat(cols[statKey]))
    .filter(value => !isNaN(value))
    .sort((a, b) => isHigherBetter ? b - a : a - b);

  return sorted.indexOf(parseFloat(playerValue)) + 1;
}

function showPlayerStats() {
  const playerNameInput = document.getElementById('searchPlayer').value.trim();

  const minGamesChecked = document.getElementById('minGames').checked;
  let filteredData = minGamesChecked ? originalData.filter(cols => parseInt(cols["ì¶œì „ ê²½ê¸° ìˆ˜"]) >= 14) : originalData;

  const playerData = filteredData.find(cols => 
    cols["Player"].trim().toLowerCase().includes(playerNameInput.toLowerCase())
  );

  if (playerData) {
    document.getElementById('playerName').innerText = playerData["Player"];
    document.getElementById('teamName').innerText = '(' + playerData["Team"] + ')';

    const statsContainer = document.getElementById('statsContainer');
    statsContainer.innerHTML = '';

    statsContainer.innerHTML += createCard('ê¸°ë³¸ ì •ë³´', [
      {label: 'ì¶œì „ ê²½ê¸° ìˆ˜', value: formatStatValue("ì¶œì „ ê²½ê¸° ìˆ˜", playerData["ì¶œì „ ê²½ê¸° ìˆ˜"]), rank: calculateRank(filteredData, "ì¶œì „ ê²½ê¸° ìˆ˜", playerData["ì¶œì „ ê²½ê¸° ìˆ˜"], true) + 'ìœ„'},
      {label: 'í‰ê·  ì¶œì „ ì‹œê°„', value: formatStatValue("ì´ ì¶œì „ ì‹œê°„(ì´ˆ)", playerData["ì´ ì¶œì „ ì‹œê°„(ì´ˆ)"]), rank: calculateRank(filteredData, "ì´ ì¶œì „ ì‹œê°„(ì´ˆ)", playerData["ì´ ì¶œì „ ì‹œê°„(ì´ˆ)"], true) + 'ìœ„'},
      {label: 'ì´ ë“ì ', value: formatStatValue("ë“ì ", playerData["ë“ì "]), rank: calculateRank(filteredData, "ë“ì ", playerData["ë“ì "], true) + 'ìœ„'},
      {label: 'í‰ê·  ë“ì ', value: formatStatValue("í‰ê·  ë“ì ", playerData["í‰ê·  ë“ì "]), rank: calculateRank(filteredData, "í‰ê·  ë“ì ", playerData["í‰ê·  ë“ì "], true) + 'ìœ„'}
    ], 'primary');

statsContainer.innerHTML += createCard('ìŠˆíŒ… ì§€í‘œ', [
      {label: 'í‰ê·  FG ì‹œë„', value: formatStatValue("í‰ê·  FG ì‹œë„", playerData["í‰ê·  FG ì‹œë„"]), rank: calculateRank(filteredData, "í‰ê·  FG ì‹œë„", playerData["í‰ê·  FG ì‹œë„"], true) + 'ìœ„'},
      {label: 'í‰ê·  FG ì„±ê³µ', value: formatStatValue("í‰ê·  FG ì„±ê³µ", playerData["í‰ê·  FG ì„±ê³µ"]), rank: calculateRank(filteredData, "í‰ê·  FG ì„±ê³µ", playerData["í‰ê·  FG ì„±ê³µ"], true) + 'ìœ„'},
      {label: 'í‰ê·  2p ì‹œë„', value: formatStatValue("í‰ê·  2p ì‹œë„", playerData["í‰ê·  2p ì‹œë„"]), rank: calculateRank(filteredData, "í‰ê·  2p ì‹œë„", playerData["í‰ê·  2p ì‹œë„"], true) + 'ìœ„'},
      {label: 'í‰ê·  2p ì„±ê³µ', value: formatStatValue("í‰ê·  2p ì„±ê³µ", playerData["í‰ê·  2p ì„±ê³µ"]), rank: calculateRank(filteredData, "í‰ê·  2p ì„±ê³µ", playerData["í‰ê·  2p ì„±ê³µ"], true) + 'ìœ„'},
      {label: 'í‰ê·  3p ì„±ê³µ', value: formatStatValue("í‰ê·  3p ì„±ê³µ", playerData["í‰ê·  3p ì„±ê³µ"]), rank: calculateRank(filteredData, "í‰ê·  3p ì„±ê³µ", playerData["í‰ê·  3p ì„±ê³µ"], true) + 'ìœ„'},
      {label: 'í‰ê·  FT ì‹œë„', value: formatStatValue("í‰ê·  FT ì‹œë„", playerData["í‰ê·  FT ì‹œë„"]), rank: calculateRank(filteredData, "í‰ê·  FT ì‹œë„", playerData["í‰ê·  FT ì‹œë„"], true) + 'ìœ„'},
      {label: 'í‰ê·  FT ì„±ê³µ', value: formatStatValue("í‰ê·  FT ì„±ê³µ", playerData["í‰ê·  FT ì„±ê³µ"]), rank: calculateRank(filteredData, "í‰ê·  FT ì„±ê³µ", playerData["í‰ê·  FT ì„±ê³µ"], true) + 'ìœ„'}
], 'primary');

statsContainer.innerHTML += createCard('ìŠˆíŒ… ì„±ê³µë¥ ', [
  {
    label: 'FG%', 
    value: formatStatValue("FG%", playerData["FG%"]), 
    rank: calculateRank(filteredData, "FG%", playerData["FG%"], true) + 'ìœ„'
  },
  {
    label: '2P%', 
    value: formatStatValue("2P%", playerData["2P%"]), 
    rank: calculateRank(filteredData, "2P%", playerData["2P%"], true) + 'ìœ„'
  },
  {
    label: '3P%', 
    value: formatStatValue("3P%", playerData["3P%"]), 
    rank: calculateRank(filteredData, "3P%", playerData["3P%"], true) + 'ìœ„'
  },
  {
    label: 'FT%', 
    value: formatStatValue("FT%", playerData["FT%"]), 
    rank: calculateRank(filteredData, "FT%", playerData["FT%"], true) + 'ìœ„'
  }
], 'primary');

statsContainer.innerHTML += createCard('ë¦¬ë°”ìš´ë“œ ì§€í‘œ', [
  {
    label: 'ì´ ë¦¬ë°”ìš´ë“œ', 
    value: formatStatValue("ë¦¬ë°”ìš´ë“œ", playerData["ë¦¬ë°”ìš´ë“œ"]), 
    rank: calculateRank(filteredData, "ë¦¬ë°”ìš´ë“œ", playerData["ë¦¬ë°”ìš´ë“œ"], true) + 'ìœ„',
    highlight: true
  },
  {
    label: 'í‰ê·  ë¦¬ë°”ìš´ë“œ', 
    value: formatStatValue("í‰ê·  ë¦¬ë°”ìš´ë“œ", playerData["í‰ê·  ë¦¬ë°”ìš´ë“œ"]), 
    rank: calculateRank(filteredData, "í‰ê·  ë¦¬ë°”ìš´ë“œ", playerData["í‰ê·  ë¦¬ë°”ìš´ë“œ"], true) + 'ìœ„',
    highlight: true
  },
  {
    label: 'ê³µê²© ë¦¬ë°”ìš´ë“œ', 
    value: formatStatValue("ê³µê²© ë¦¬ë°”ìš´ë“œ", playerData["ê³µê²© ë¦¬ë°”ìš´ë“œ"]), 
    rank: calculateRank(filteredData, "ê³µê²© ë¦¬ë°”ìš´ë“œ", playerData["ê³µê²© ë¦¬ë°”ìš´ë“œ"], true) + 'ìœ„'
  },
  {
    label: 'í‰ê·  ê³µê²© ë¦¬ë°”ìš´ë“œ', 
    value: formatStatValue("í‰ê·  ê³µê²© ë¦¬ë°”ìš´ë“œ", playerData["í‰ê·  ê³µê²© ë¦¬ë°”ìš´ë“œ"]), 
    rank: calculateRank(filteredData, "í‰ê·  ê³µê²© ë¦¬ë°”ìš´ë“œ", playerData["í‰ê·  ê³µê²© ë¦¬ë°”ìš´ë“œ"], true) + 'ìœ„'
  },
  {
    label: 'ìˆ˜ë¹„ ë¦¬ë°”ìš´ë“œ', 
    value: formatStatValue("ìˆ˜ë¹„ ë¦¬ë°”ìš´ë“œ", playerData["ìˆ˜ë¹„ ë¦¬ë°”ìš´ë“œ"]), 
    rank: calculateRank(filteredData, "ìˆ˜ë¹„ ë¦¬ë°”ìš´ë“œ", playerData["ìˆ˜ë¹„ ë¦¬ë°”ìš´ë“œ"], true) + 'ìœ„'
  },
  {
    label: 'í‰ê·  ìˆ˜ë¹„ ë¦¬ë°”ìš´ë“œ', 
    value: formatStatValue("í‰ê·  ìˆ˜ë¹„ ë¦¬ë°”ìš´ë“œ", playerData["í‰ê·  ìˆ˜ë¹„ ë¦¬ë°”ìš´ë“œ"]), 
    rank: calculateRank(filteredData, "í‰ê·  ìˆ˜ë¹„ ë¦¬ë°”ìš´ë“œ", playerData["í‰ê·  ìˆ˜ë¹„ ë¦¬ë°”ìš´ë“œ"], true) + 'ìœ„'
  }
], 'primary');

statsContainer.innerHTML += createCard('ì–´ì‹œìŠ¤íŠ¸/ìŠ¤í‹¸/ë¸”ë¡ ì§€í‘œ', [
  {
    label: 'ì´ ì–´ì‹œìŠ¤íŠ¸', 
    value: formatStatValue("ì–´ì‹œìŠ¤íŠ¸", playerData["ì–´ì‹œìŠ¤íŠ¸"]), 
    rank: calculateRank(filteredData, "ì–´ì‹œìŠ¤íŠ¸", playerData["ì–´ì‹œìŠ¤íŠ¸"], true) + 'ìœ„'
  },
  {
    label: 'í‰ê·  ì–´ì‹œìŠ¤íŠ¸', 
    value: formatStatValue("í‰ê·  ì–´ì‹œìŠ¤íŠ¸", playerData["í‰ê·  ì–´ì‹œìŠ¤íŠ¸"]), 
    rank: calculateRank(filteredData, "í‰ê·  ì–´ì‹œìŠ¤íŠ¸", playerData["í‰ê·  ì–´ì‹œìŠ¤íŠ¸"], true) + 'ìœ„'
  },
  {
    label: 'ì´ ìŠ¤í‹¸', 
    value: formatStatValue("ìŠ¤í‹¸", playerData["ìŠ¤í‹¸"]), 
    rank: calculateRank(filteredData, "ìŠ¤í‹¸", playerData["ìŠ¤í‹¸"], true) + 'ìœ„'
  },
  {
    label: 'í‰ê·  ìŠ¤í‹¸', 
    value: formatStatValue("í‰ê·  ìŠ¤í‹¸", playerData["í‰ê·  ìŠ¤í‹¸"]), 
    rank: calculateRank(filteredData, "í‰ê·  ìŠ¤í‹¸", playerData["í‰ê·  ìŠ¤í‹¸"], true) + 'ìœ„'
  },
  {
    label: 'ì´ ë¸”ë¡', 
    value: formatStatValue("ë¸”ë¡", playerData["ë¸”ë¡"]), 
    rank: calculateRank(filteredData, "ë¸”ë¡", playerData["ë¸”ë¡"], true) + 'ìœ„'
  },
  {
    label: 'í‰ê·  ë¸”ë¡', 
    value: formatStatValue("í‰ê·  ë¸”ë¡", playerData["í‰ê·  ë¸”ë¡"]), 
    rank: calculateRank(filteredData, "í‰ê·  ë¸”ë¡", playerData["í‰ê·  ë¸”ë¡"], true) + 'ìœ„'
  }
], 'primary');

statsContainer.innerHTML += createCard('ê¸°íƒ€ ì§€í‘œ', [
  {
    label: 'í„´ì˜¤ë²„', 
    value: formatStatValue("í„´ì˜¤ë²„", playerData["í„´ì˜¤ë²„"]), 
    rank: calculateRank(filteredData, "í„´ì˜¤ë²„", playerData["í„´ì˜¤ë²„"], false) + 'ìœ„'
  },
  {
    label: 'í‰ê·  í„´ì˜¤ë²„', 
    value: formatStatValue("í‰ê·  í„´ì˜¤ë²„", playerData["í‰ê·  í„´ì˜¤ë²„"]), 
    rank: calculateRank(filteredData, "í‰ê·  í„´ì˜¤ë²„", playerData["í‰ê·  í„´ì˜¤ë²„"], false) + 'ìœ„'
  },
  {
    label: 'íŒŒìš¸', 
    value: formatStatValue("íŒŒìš¸", playerData["íŒŒìš¸"]), 
    rank: calculateRank(filteredData, "íŒŒìš¸", playerData["íŒŒìš¸"], false) + 'ìœ„'
  },
  {
    label: 'í‰ê·  íŒŒìš¸', 
    value: formatStatValue("í‰ê·  íŒŒìš¸", playerData["í‰ê·  íŒŒìš¸"]), 
    rank: calculateRank(filteredData, "í‰ê·  íŒŒìš¸", playerData["í‰ê·  íŒŒìš¸"], false) + 'ìœ„'
  }
], 'primary');



statsContainer.innerHTML += createCard('WinShare ì§€í‘œ', [
  {label: 'WS', value: formatStatValue("WS", playerData["WS"]), rank: calculateRank(filteredData, "WS", playerData["WS"], true) + 'ìœ„', highlight: true},
  {label: 'WS/40', value: formatStatValue("WS/40", playerData["WS/40"]), rank: calculateRank(filteredData, "WS/40", playerData["WS/40"], true) + 'ìœ„'},
  {label: 'Offensive_WS', value: formatStatValue("Offensive_WS", playerData["Offensive_WS"]), rank: calculateRank(filteredData, "Offensive_WS", playerData["Offensive_WS"], true) + 'ìœ„'},
  {label: 'Defensive_WS', value: formatStatValue("Defensive_WS", playerData["Defensive_WS"]), rank: calculateRank(filteredData, "Defensive_WS", playerData["Defensive_WS"], true) + 'ìœ„'}
], 'secondary');

statsContainer.innerHTML += createCard('íš¨ìœ¨ì„± ì§€í‘œ', [
  {label: 'PER', value: formatStatValue("PER", playerData["PER"]), rank: calculateRank(filteredData, "PER", playerData["PER"], true) + 'ìœ„'},
  {label: 'EFF', value: formatStatValue("EFF", playerData["EFF"]), rank: calculateRank(filteredData, "EFF", playerData["EFF"], true) + 'ìœ„'},
  {label: 'EFF/40', value: formatStatValue("EFF/40", playerData["EFF/40"]), rank: calculateRank(filteredData, "EFF/40", playerData["EFF/40"], true) + 'ìœ„'},
  {label: 'Offensive_rating', value: formatStatValue("Offensive_rating", playerData["Offensive_rating"]), rank: calculateRank(filteredData, "Offensive_rating", playerData["Offensive_rating"], true) + 'ìœ„'},
  {label: 'Defensive_rating', value: formatStatValue("Defensive_rating", playerData["Defensive_rating"]), rank: calculateRank(filteredData, "Defensive_rating", playerData["Defensive_rating"], false) + 'ìœ„'},
  {label: 'USG%', value: formatStatValue("USG%", playerData["USG%"]), rank: calculateRank(filteredData, "USG%", playerData["USG%"], true) + 'ìœ„'}
], 'secondary');

statsContainer.innerHTML += createCard('2ì°¨ ìŠˆíŒ… ì§€í‘œ', [
  {label: 'TS%', value: formatStatValue("TS%", playerData["TS%"]), rank: calculateRank(filteredData, "TS%", playerData["TS%"], true) + 'ìœ„'},
  {label: 'eFG%', value: formatStatValue("eFG%", playerData["eFG%"]), rank: calculateRank(filteredData, "eFG%", playerData["eFG%"], true) + 'ìœ„'},
  {label: '3PAr', value: formatStatValue("3PAr", playerData["3PAr"]), rank: calculateRank(filteredData, "3PAr", playerData["3PAr"], true) + 'ìœ„'},
  {label: 'FTr', value: formatStatValue("FTr", playerData["FTr"]), rank: calculateRank(filteredData, "FTr", playerData["FTr"], true) + 'ìœ„'}
], 'secondary');

statsContainer.innerHTML += createCard('Teamë‚´ ë¹„ì¤‘ ì§€í‘œ', [
  {label: 'ORB%', value: formatStatValue("ORB%", playerData["ORB%"]), rank: calculateRank(filteredData, "ORB%", playerData["ORB%"], true) + 'ìœ„'},
  {label: 'DRB%', value: formatStatValue("DRB%", playerData["DRB%"]), rank: calculateRank(filteredData, "DRB%", playerData["DRB%"], true) + 'ìœ„'},
  {label: 'TRB%', value: formatStatValue("TRB%", playerData["TRB%"]), rank: calculateRank(filteredData, "TRB%", playerData["TRB%"], true) + 'ìœ„'},
  {label: 'AST%', value: formatStatValue("AST%", playerData["AST%"]), rank: calculateRank(filteredData, "AST%", playerData["AST%"], true) + 'ìœ„'},
  {label: 'STL%', value: formatStatValue("STL%", playerData["STL%"]), rank: calculateRank(filteredData, "STL%", playerData["STL%"], true) + 'ìœ„'},
  {label: 'BS%', value: formatStatValue("BS%", playerData["BS%"]), rank: calculateRank(filteredData, "BS%", playerData["BS%"], true) + 'ìœ„'},
  {label: 'TOV%', value: formatStatValue("TOV%", playerData["TOV%"]), rank: calculateRank(filteredData, "TOV%", playerData["TOV%"], false) + 'ìœ„'}
], 'team-stats');



  } else {
    alert('ì„ ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
  }
}
 document.getElementById('searchPlayerAll').addEventListener('keypress', function(e) {
  if (e.key === 'Enter') {
    searchPlayer();
  }
});

function createCard(title, stats, type = 'primary') {
  return 
    <div class="card ${type}">
      <h3>${title}</h3>
      <table>
        <thead>
          <tr>
            <th>ì§€í‘œ</th>
            <th>ê¸°ë¡</th>
            <th>ìˆœìœ„</th>
          </tr>
        </thead>
        <tbody>
          ${stats.map(stat => 
            <tr>
              <td>${stat.label}</td>
              <td>${stat.value}</td>
              <td>${stat.rank}</td>
            </tr>
          ).join('')}
        </tbody>
      </table>
    </div>
  ;
}


// ê°œì¸ ì„ ìˆ˜ íƒ­ ê²€ìƒ‰ì°½ì—ì„œ ì—”í„° í‚¤ ë™ì‘
document.getElementById('searchPlayer').addEventListener('keypress', function(e) {
  if (e.key === 'Enter') {
    showPlayerStats();
  }
});
// âœ… ì„ ìˆ˜ ê°œì¸ ê²€ìƒ‰ í˜ì´ì§€ ì²´í¬ë°•ìŠ¤ ì´ë²¤íŠ¸ ì¶”ê°€ (ì™„ë²½í•´ê²°)
document.getElementById('minGames').addEventListener('change', function() {
  const playerInput = document.getElementById('searchPlayer').value.trim();
  if (playerInput !== "") {
    showPlayerStats();  // Player ì…ë ¥ë˜ì–´ ìˆìœ¼ë©´ ë°”ë¡œ ë‹¤ì‹œ ê²€ìƒ‰
  }
});

function formatStatValue(key, value) {
  const format = statsFormats[key];
  if (!format) return value;

  const percentExcludedKeys = ['ORB%', 'DRB%', 'TRB%', 'AST%', 'STL%', 'BS%', 'TOV%'];

  if (key === "ì´ ì¶œì „ ì‹œê°„(ì´ˆ)" || format.unit === 'ë¶„ ì´ˆ') {
    const totalSeconds = parseInt(value, 10);
    const minutes = Math.floor(totalSeconds / 60);
    const seconds = totalSeconds % 60;
    return ${minutes}ë¶„ ${seconds}ì´ˆ;
  }

  let numericValue = parseFloat(value);

  // âœ… í¼ì„¼íŠ¸ í•­ëª© ë³´ì •: ê°’ì´ 1 ë¯¸ë§Œì´ë©´ 100ì„ ê³±í•´ì„œ % í˜•íƒœë¡œ ì „í™˜
  if (format.unit === '%' && !percentExcludedKeys.includes(key) && numericValue < 1.0) {
    numericValue *= 100;
  }

  const formattedValue = numericValue.toFixed(format.decimals);

  if (percentExcludedKeys.includes(key)) {
    return formattedValue; // ë‹¨ìœ„ ì œê±° ëŒ€ìƒ
  }

  return formattedValue + (format.unit !== 'ë¶„ ì´ˆ' ? format.unit : '');
}


function comparePlayers() {
  const player1 = document.getElementById('comparePlayer1').value.trim();
  const player2 = document.getElementById('comparePlayer2').value.trim();
  const player3 = document.getElementById('comparePlayer3').value.trim();
  const minGamesChecked = document.getElementById('compareMinGames').checked;

  let filteredData = minGamesChecked
    ? originalData.filter(cols => parseInt(cols["ì¶œì „ ê²½ê¸° ìˆ˜"]) >= 14)
    : originalData;

  const playersData = [player1, player2, player3]
    .filter(name => name !== '')
    .map(name => filteredData.find(cols => cols["Player"].trim().toLowerCase().includes(name.trim().toLowerCase())));

  if (playersData.some(data => data === undefined)) {
    alert('ì„ ìˆ˜ ì´ë¦„ì„ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”.');
    return;
  }

  const statsLabels = [
    {label: 'ì¶œì „ ê²½ê¸° ìˆ˜', key: "ì¶œì „ ê²½ê¸° ìˆ˜", higherBetter: true},
    {label: 'í‰ê·  ì¶œì „ ì‹œê°„', key: "ì´ ì¶œì „ ì‹œê°„(ì´ˆ)", higherBetter: true},
    {label: 'ë“ì ', key: "ë“ì ", higherBetter: true},
    {label: 'í‰ê·  ë“ì ', key: "í‰ê·  ë“ì ", higherBetter: true},
    {label: 'FGA', key: "FGA", higherBetter: true},
    {label: 'FG', key: "FG", higherBetter: true},
    {label: 'í‰ê·  FG ì‹œë„', key: "í‰ê·  FG ì‹œë„", higherBetter: true},
    {label: 'í‰ê·  FG ì„±ê³µ', key: "í‰ê·  FG ì„±ê³µ", higherBetter: true},
    {label: 'FG%', key: "FG%", higherBetter: true},
    {label: '2PA', key: "2PA", higherBetter: true},
    {label: '2P', key: "2P", higherBetter: true},
    {label: 'í‰ê·  2p ì‹œë„', key: "í‰ê·  2p ì‹œë„", higherBetter: true},
    {label: 'í‰ê·  2p ì„±ê³µ', key: "í‰ê·  2p ì„±ê³µ", higherBetter: true},
    {label: '2P%', key: "2P%", higherBetter: true},
    {label: '3PA', key: "3PA", higherBetter: true},
    {label: '3P', key: "3P", higherBetter: true},
    {label: 'í‰ê·  3p ì‹œë„', key: "í‰ê·  3p ì‹œë„", higherBetter: true},
    {label: 'í‰ê·  3p ì„±ê³µ', key: "í‰ê·  3p ì„±ê³µ", higherBetter: true},
    {label: '3P%', key: "3P%", higherBetter: true},
    {label: 'FTA', key: "FTA", higherBetter: true},
    {label: 'FT', key: "FT", higherBetter: true},
    {label: 'í‰ê·  FT ì‹œë„', key: "í‰ê·  FT ì‹œë„", higherBetter: true},
    {label: 'í‰ê·  FT ì„±ê³µ', key: "í‰ê·  FT ì„±ê³µ", higherBetter: true},
    {label: 'FT%', key: "FT%", higherBetter: true},
    {label: 'ë¦¬ë°”ìš´ë“œ', key: "ë¦¬ë°”ìš´ë“œ", higherBetter: true},
    {label: 'í‰ê·  ë¦¬ë°”ìš´ë“œ', key: "í‰ê·  ë¦¬ë°”ìš´ë“œ", higherBetter: true},
    {label: 'ê³µê²© ë¦¬ë°”ìš´ë“œ', key: "ê³µê²© ë¦¬ë°”ìš´ë“œ", higherBetter: true},
    {label: 'í‰ê·  ê³µê²© ë¦¬ë°”ìš´ë“œ', key: "í‰ê·  ê³µê²© ë¦¬ë°”ìš´ë“œ", higherBetter: true},
    {label: 'ìˆ˜ë¹„ ë¦¬ë°”ìš´ë“œ', key: "ìˆ˜ë¹„ ë¦¬ë°”ìš´ë“œ", higherBetter: true},
    {label: 'í‰ê·  ìˆ˜ë¹„ ë¦¬ë°”ìš´ë“œ', key: "í‰ê·  ìˆ˜ë¹„ ë¦¬ë°”ìš´ë“œ", higherBetter: true},
    {label: 'ì–´ì‹œìŠ¤íŠ¸', key: "ì–´ì‹œìŠ¤íŠ¸", higherBetter: true},
    {label: 'í‰ê·  ì–´ì‹œìŠ¤íŠ¸', key: "í‰ê·  ì–´ì‹œìŠ¤íŠ¸", higherBetter: true},
    {label: 'ìŠ¤í‹¸', key: "ìŠ¤í‹¸", higherBetter: true},
    {label: 'í‰ê·  ìŠ¤í‹¸', key: "í‰ê·  ìŠ¤í‹¸", higherBetter: true},
    {label: 'ë¸”ë¡', key: "ë¸”ë¡", higherBetter: true},
    {label: 'í‰ê·  ë¸”ë¡', key: "í‰ê·  ë¸”ë¡", higherBetter: true},
    {label: 'í„´ì˜¤ë²„', key: "í„´ì˜¤ë²„", higherBetter: false},
    {label: 'í‰ê·  í„´ì˜¤ë²„', key: "í‰ê·  í„´ì˜¤ë²„", higherBetter: false},
    {label: 'íŒŒìš¸', key: "íŒŒìš¸", higherBetter: false},
    {label: 'í‰ê·  íŒŒìš¸', key: "í‰ê·  íŒŒìš¸", higherBetter: false},
    {label: 'WS', key: "WS", higherBetter: true},
    {label: 'WS/40', key: "WS/40", higherBetter: true},
    {label: 'Offensive_WS', key: "Offensive_WS", higherBetter: true},
    {label: 'Defensive_WS', key: "Defensive_WS", higherBetter: true},
    {label: 'Offensive_rating', key: "Offensive_rating", higherBetter: true},
    {label: 'Defensive_rating', key: "Defensive_rating", higherBetter: false},
    {label: 'PER', key: "PER", higherBetter: true},
    {label: 'EFF', key: "EFF", higherBetter: true},
    {label: 'EFF/40', key: "EFF/40", higherBetter: true},
    {label: 'TS%', key: "TS%", higherBetter: true},
    {label: 'eFG%', key: "eFG%", higherBetter: true},
    {label: 'USG%', key: "USG%", higherBetter: true},
    {label: '3PAr', key: "3PAr", higherBetter: true},
    {label: 'FTr', key: "FTr", higherBetter: true},
    {label: 'ORB%', key: "ORB%", higherBetter: true},
    {label: 'DRB%', key: "DRB%", higherBetter: true},
    {label: 'TRB%', key: "TRB%", higherBetter: true},
    {label: 'AST%', key: "AST%", higherBetter: true},
    {label: 'STL%', key: "STL%", higherBetter: true},
    {label: 'BS%', key: "BS%", higherBetter: true},
    {label: 'TOV%', key: "TOV%", higherBetter: false}
  ];

  let tableHTML = <table><thead><tr><th>ì§€í‘œ</th>${playersData.map(p => <th>${p["Player"]} (${p["Team"]})</th>).join('')}${playersData.length === 2 ? <th>ì°¨ì´</th> : ''}</tr></thead><tbody>;

  statsLabels.forEach(stat => {
    const values = playersData.map(p => parseFloat(p[stat.key]) || 0);
    const ranks = values.map(val => calculateRank(filteredData, stat.key, val, stat.higherBetter));

    let highlightClass = [];
    if (values.length >= 2) {
      const sortedValues = [...values].sort((a, b) => stat.higherBetter ? b - a : a - b);
      highlightClass = values.map(v => {
        if (v === sortedValues[0]) return 'highlight-first';
        if (values.length > 2 && v === sortedValues[1]) return 'highlight-second';
        return 'highlight-third';
      });
    }

    tableHTML += <tr data-category="${getCategoryByStat(stat.label)}"><td>${stat.label}</td>;

    values.forEach((value, idx) => {
      tableHTML += <td class="${highlightClass[idx]}">${formatStatValue(stat.key, value)} (${ranks[idx]}ìœ„)</td>;
    });

    if (playersData.length === 2) {
      const diff = values[0] - values[1];
      const diffClass = diff > 0 ? 'diff-positive' : diff < 0 ? 'diff-negative' : '';
const format = statsFormats[stat.key] || {unit: '', decimals: 2};

let formattedDiff;
if (stat.key === "ì´ ì¶œì „ ì‹œê°„(ì´ˆ)" || format.unit === 'ë¶„ ì´ˆ') {
  const diffSeconds = Math.abs(diff);
  const minutes = Math.floor(diffSeconds / 60);
  const seconds = diffSeconds % 60;
  formattedDiff = ${minutes}ë¶„ ${seconds}ì´ˆ;
} else if (format.decimals === 0) {
  formattedDiff = ${Math.abs(diff)}${format.unit};
} else {
  formattedDiff = ${Math.abs(diff).toFixed(format.decimals)}${format.unit};
}



      tableHTML += <td class="diff-cell ${diffClass}"><span>${formattedDiff}</span></td>;
    }

    tableHTML += '</tr>';
  });

  tableHTML += '</tbody></table>';
  document.getElementById('compareResult').innerHTML = tableHTML;
  filterCompareTable();
}




// ì—”í„°í‚¤ ì…ë ¥ ê¸°ëŠ¥ ì¶”ê°€ (ìœ ì§€)
['comparePlayer1', 'comparePlayer2', 'comparePlayer3'].forEach(id => {
  document.getElementById(id).addEventListener('keypress', function(e) {
if (e.key === 'Enter') comparePlayers();
  });
});

// ì²´í¬ë°•ìŠ¤ ì¦‰ì‹œ ë°˜ì‘ ì¶”ê°€ (ìœ ì§€)
document.getElementById('compareMinGames').addEventListener('change', () => {
  comparePlayers();
});

// ì²´í¬ë°•ìŠ¤ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì¶”ê°€
document.querySelectorAll('#categoryCheckboxes input[type="checkbox"]').forEach(checkbox => {
  checkbox.addEventListener('change', filterCompareTable);
});

// ì²´í¬ë°•ìŠ¤ í•„í„°ë§ í•¨ìˆ˜ ì •ì˜
function filterCompareTable() {
  const checkedCategories = Array.from(document.querySelectorAll('#categoryCheckboxes input[type="checkbox"]:checked'))
                                 .map(cb => cb.value);

  document.querySelectorAll('#compareResult tbody tr').forEach(row => {
    const category = row.getAttribute('data-category');
    row.style.display = checkedCategories.includes(category) ? '' : 'none';
  });
}

// ì§€í‘œ â†’ ì¹´í…Œê³ ë¦¬ ë³€í™˜ í•¨ìˆ˜ ì¶”ê°€ (ë§¨ ëì— ì¶”ê°€)
function getCategoryByStat(statLabel) {
  const categoryMap = {
    'ì¶œì „ ê²½ê¸° ìˆ˜': 'ê¸°ë³¸ ì •ë³´',
    'í‰ê·  ì¶œì „ ì‹œê°„': 'ê¸°ë³¸ ì •ë³´',
    'ë“ì ': 'ê¸°ë³¸ ì •ë³´',
    'í‰ê·  ë“ì ': 'ê¸°ë³¸ ì •ë³´',

    'í‰ê·  FG ì‹œë„': 'ìŠˆíŒ… ì§€í‘œ',
    'í‰ê·  FG ì„±ê³µ': 'ìŠˆíŒ… ì§€í‘œ',
    'í‰ê·  2p ì‹œë„': 'ìŠˆíŒ… ì§€í‘œ',
    'í‰ê·  2p ì„±ê³µ': 'ìŠˆíŒ… ì§€í‘œ',
    'í‰ê·  3p ì„±ê³µ': 'ìŠˆíŒ… ì§€í‘œ',
    'í‰ê·  3p ì„±ê³µ': 'ìŠˆíŒ… ì§€í‘œ',
    'í‰ê·  FT ì‹œë„': 'ìŠˆíŒ… ì§€í‘œ',
    'í‰ê·  FT ì„±ê³µ': 'ìŠˆíŒ… ì§€í‘œ',

    'FG%': 'ìŠˆíŒ… ì„±ê³µë¥ ',
    '2P%': 'ìŠˆíŒ… ì„±ê³µë¥ ',
    '3P%': 'ìŠˆíŒ… ì„±ê³µë¥ ',
    'FT%': 'ìŠˆíŒ… ì„±ê³µë¥ ',

    'ë¦¬ë°”ìš´ë“œ': 'ë¦¬ë°”ìš´ë“œ ì§€í‘œ',
    'í‰ê·  ë¦¬ë°”ìš´ë“œ': 'ë¦¬ë°”ìš´ë“œ ì§€í‘œ',
    'ê³µê²© ë¦¬ë°”ìš´ë“œ': 'ë¦¬ë°”ìš´ë“œ ì§€í‘œ',
    'í‰ê·  ê³µê²© ë¦¬ë°”ìš´ë“œ': 'ë¦¬ë°”ìš´ë“œ ì§€í‘œ',
    'ìˆ˜ë¹„ ë¦¬ë°”ìš´ë“œ': 'ë¦¬ë°”ìš´ë“œ ì§€í‘œ',
    'í‰ê·  ìˆ˜ë¹„ ë¦¬ë°”ìš´ë“œ': 'ë¦¬ë°”ìš´ë“œ ì§€í‘œ',

    'ì–´ì‹œìŠ¤íŠ¸': 'ì–´ì‹œìŠ¤íŠ¸/ìŠ¤í‹¸/ë¸”ë¡ ì§€í‘œ',
    'í‰ê·  ì–´ì‹œìŠ¤íŠ¸': 'ì–´ì‹œìŠ¤íŠ¸/ìŠ¤í‹¸/ë¸”ë¡ ì§€í‘œ',
    'ìŠ¤í‹¸': 'ì–´ì‹œìŠ¤íŠ¸/ìŠ¤í‹¸/ë¸”ë¡ ì§€í‘œ',
    'í‰ê·  ìŠ¤í‹¸': 'ì–´ì‹œìŠ¤íŠ¸/ìŠ¤í‹¸/ë¸”ë¡ ì§€í‘œ',
    'ë¸”ë¡': 'ì–´ì‹œìŠ¤íŠ¸/ìŠ¤í‹¸/ë¸”ë¡ ì§€í‘œ',
    'í‰ê·  ë¸”ë¡': 'ì–´ì‹œìŠ¤íŠ¸/ìŠ¤í‹¸/ë¸”ë¡ ì§€í‘œ',

    'í„´ì˜¤ë²„': 'ê¸°íƒ€ ì§€í‘œ',
    'í‰ê·  í„´ì˜¤ë²„': 'ê¸°íƒ€ ì§€í‘œ',
    'íŒŒìš¸': 'ê¸°íƒ€ ì§€í‘œ',
    'í‰ê·  íŒŒìš¸': 'ê¸°íƒ€ ì§€í‘œ',

    'WS': 'WinShare ì§€í‘œ',
    'WS/40': 'WinShare ì§€í‘œ',
    'Offensive_WS': 'WinShare ì§€í‘œ',
    'Defensive_WS': 'WinShare ì§€í‘œ',

    'PER': 'íš¨ìœ¨ì„± ì§€í‘œ',
    'EFF': 'íš¨ìœ¨ì„± ì§€í‘œ',
    'EFF/40': 'íš¨ìœ¨ì„± ì§€í‘œ',
    'Offensive_rating': 'íš¨ìœ¨ì„± ì§€í‘œ',
    'Defensive_rating': 'íš¨ìœ¨ì„± ì§€í‘œ',
    'USG%': 'íš¨ìœ¨ì„± ì§€í‘œ',

    'TS%': '2ì°¨ ìŠˆíŒ… ì§€í‘œ',
    'eFG%': '2ì°¨ ìŠˆíŒ… ì§€í‘œ',
    '3PAr': '2ì°¨ ìŠˆíŒ… ì§€í‘œ',
    'FTr': '2ì°¨ ìŠˆíŒ… ì§€í‘œ',

    'ORB%': 'Teamë‚´ ë¹„ì¤‘ ì§€í‘œ',
    'DRB%': 'Teamë‚´ ë¹„ì¤‘ ì§€í‘œ',
    'TRB%': 'Teamë‚´ ë¹„ì¤‘ ì§€í‘œ',
    'AST%': 'Teamë‚´ ë¹„ì¤‘ ì§€í‘œ',
    'STL%': 'Teamë‚´ ë¹„ì¤‘ ì§€í‘œ',
    'BS%': 'Teamë‚´ ë¹„ì¤‘ ì§€í‘œ',
    'TOV%': 'Teamë‚´ ë¹„ì¤‘ ì§€í‘œ'
  };
  return categoryMap[statLabel] || 'ê¸°íƒ€ ì§€í‘œ';
}

// ìµœì´ˆ ì‹¤í–‰ ì‹œ ëª¨ë“  ì²´í¬ë°•ìŠ¤ ì„ íƒ ìƒíƒœë¡œ ì‹œì‘
window.addEventListener('DOMContentLoaded', () => {
  filterCompareTable();
});

async function loadLocalFile() {
  const fileInput = document.getElementById('fileUploader');

  if (fileInput.files.length === 0) {
    alert('ì—‘ì…€ íŒŒì¼ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.');
    return;
  }

  const file = fileInput.files[0];
  const reader = new FileReader();

  reader.onload = function(e) {
    const data = new Uint8Array(e.target.result);
    const workbook = XLSX.read(data, {type: 'array'});

    const firstSheet = workbook.SheetNames[0];
    originalData = XLSX.utils.sheet_to_json(workbook.Sheets[firstSheet]);

    originalData.forEach(cols => {
      let minutes = parseInt(cols["m"]) || 0;
      let seconds = parseInt(cols["s"]) || 0;
      cols["ì´ ì¶œì „ ì‹œê°„(ì´ˆ)"] = minutes * 60 + seconds;
    });

    renderTable(originalData);
    alert("ì—‘ì…€ íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!");
  };

  reader.onerror = function(e) {
    console.error("íŒŒì¼ ë¡œë”© ì˜¤ë¥˜", e);
    alert("íŒŒì¼ ë¡œë”© ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
  };

  reader.readAsArrayBuffer(file);
}

  
 </script>

 
 </body>
 </html>
